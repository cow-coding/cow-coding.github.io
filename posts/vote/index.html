<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스" /><meta property="og:locale" content="en" /><meta name="description" content="시작하며" /><meta property="og:description" content="시작하며" /><link rel="canonical" href="https://cow-coding.github.io/posts/vote/" /><meta property="og:url" content="https://cow-coding.github.io/posts/vote/" /><meta property="og:site_name" content="Coding Gallery" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-27T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="TXb5nWUV5Ag0O8EVGMTUS11ZVi7BYOensPMiRdQGNRg" /> <script type="application/ld+json"> {"description":"시작하며","url":"https://cow-coding.github.io/posts/vote/","@type":"BlogPosting","headline":"[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스","dateModified":"2022-01-28T14:10:54+09:00","datePublished":"2021-07-27T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cow-coding.github.io/posts/vote/"},"@context":"https://schema.org"}</script><title>[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스 | Coding Gallery</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Coding Gallery"><meta name="application-name" content="Coding Gallery"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4761810170892865" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/my_img/icebear.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Coding Gallery</a></div><div class="site-subtitle font-italic">마침표를 찍고 조금 더 멀리</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cow-coding" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kbp0237','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/cow-coding">Park Kibum</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-07-27 00:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 27, 2021, 12:00 AM +0900" >Jul 27, 2021</em> </span> <span> Updated <em class="timeago" date="2022-01-28 14:10:54 +0900 " data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 28, 2022, 2:10 PM +0900" >Jan 28, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1578 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h3 id="시작하며"><strong>시작하며</strong> <a href="#시작하며" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>3학년 1학기에 수강하는 데이터베이스 과목의 최종 프로젝트는 <a href="http://data.go.kr">공공데이터 포털</a>의 공공 데이터를 활용하여 서비스를 제작하는 것이었습니다. 한학기 동안 진행되는 3개월 프로젝트였으며 저는 제 동기 한명과 팀을 이뤄서 서비스 제작을 했습니다. 프로젝트를 구상하던 당시에 서울특별시장 선거를 포함한 보궐선거가 진행되던 시기라 선거정보 및 국회의원 정보를 제공하는 서비스를 제작하기로 했습니다. 공공데이터 포털에 중앙선거관리위원회의 선거 정보들과 국회 사무처 제공의 국회의원 정보 데이터를 활용했습니다. </p><p>서비스는 100% 웹 어플리케이션으로 기획하였으며 기반 백엔드언어는 Node.js를 활용하였습니다. 실제 임시 배포를 하고자 GCP를 사용하였고 서버를 기반으로 하는 GCP OS는 우분투로 하였습니다.</p><p>제가 맡은 부분은 데이터베이스 구축과 이를 위한 데이터 파싱작업과 백엔드 API 제작이었습니다.</p><hr /><h3 id="디렉토리-구조"><strong>디렉토리 구조</strong> <a href="#디렉토리-구조" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>├── README.md
├── node_modules
│   └── ...
│   ...
│   └── ...
├── imgs
│   ├── title1.png
│   └── title2.png
├── models
├── package-lock.json
├── package.json
├── public
│   └── src
│       ├── readmore.min.js
│       ├── search.png
│       ├── sidebar.css
│       ├── sidebar_bgd.png
│       ├── stamp.png
│       ├── style.css
│       └── w3_sidebar.css
├── router
│   └── main.js
├── server.js
└── views
    ├── CandInfo.html
    ├── CandProm.html
    ├── Member.html
    ├── PollPlace.html
    ├── PrevElec.html
    ├── about.html
    └── index.html
</pre></table></code></div></div><hr /><h3 id="데이터-수집-및-파싱"><strong>데이터 수집 및 파싱</strong> <a href="#데이터-수집-및-파싱" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>데이터베이스는 MySQL을 사용하여 저장했습니다. 이에 따라 테이블 설계를 진행했고 총 6개의 테이블이 설계되었습니다. 각 테이블에 필요한 데이터를 공공데이터 포털의 API를 통해 불러오고 파싱하는 작업을 했습니다. 데이터 파싱과 데이터프레임 제작은 재사용성 향상과 수정의 편의를 위해 모두 모듈화를 통해 제작했습니다.</p><p><strong>1. 사용 라이브러리</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span><span class="p">,</span> <span class="n">quote_plus</span><span class="p">,</span> <span class="n">unquote</span><span class="p">,</span> <span class="n">quote</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">pandas.io.json</span> <span class="kn">import</span> <span class="n">json_normalize</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pymysql</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">xmltodict</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="n">mp</span>
<span class="kn">import</span> <span class="nn">cryptography</span>

<span class="n">pymysql</span><span class="p">.</span><span class="n">install_as_MySQLdb</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">MySQLdb</span>
</pre></table></code></div></div><p>모든 API는 json형식으로 로드하였지만 일부 API는 xml만 한정적으로 로드하기 때문에 xmltodict라이브러리를 추가로 사용했습니다. mysql연결을 위해 sqlalchemy와 pymysql을 활용했습니다.</p><p><strong>2. 데이터 파싱 및 데이터프레임 제작</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_election_df</span><span class="p">(</span><span class="n">pg_num</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_row</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
  <span class="n">election_base_url</span> <span class="o">=</span> <span class="s">'http://apis.data.go.kr/9760000/CommonCodeService/getCommonSgCodeList'</span>

  <span class="n">page_no</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pg_num</span><span class="p">)</span>
  <span class="n">num_of_rows</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_row</span><span class="p">)</span>                                  <span class="c1"># maximum 34 datas
</span>
  <span class="n">queryParams</span> <span class="o">=</span> <span class="s">'?'</span> <span class="o">+</span> <span class="n">urlencode</span><span class="p">({</span>
      <span class="n">quote_plus</span><span class="p">(</span><span class="s">'pageNo'</span><span class="p">)</span> <span class="p">:</span> <span class="n">page_no</span><span class="p">,</span>
      <span class="n">quote_plus</span><span class="p">(</span><span class="s">'numOfRows'</span><span class="p">)</span> <span class="p">:</span> <span class="n">num_of_rows</span><span class="p">,</span>
      <span class="n">quote_plus</span><span class="p">(</span><span class="s">'resultType'</span><span class="p">)</span> <span class="p">:</span> <span class="s">'json'</span><span class="p">,</span>
      <span class="n">quote_plus</span><span class="p">(</span><span class="s">'ServiceKey'</span><span class="p">)</span> <span class="p">:</span> <span class="n">service_key</span> 
  <span class="p">})</span>

  <span class="n">API_election_code_url</span> <span class="o">=</span> <span class="n">election_base_url</span> <span class="o">+</span> <span class="n">unquote</span><span class="p">(</span><span class="n">queryParams</span><span class="p">)</span>

  <span class="c1"># Election code load
</span>
  <span class="s">'''
  &lt; election code &gt;
  (0)대표선거명               
  (1)대통령,(2)국회의원,(3)시도지사,(4)구시군장,(5)시도의원,(6)구시군의회의원
  (7)국회의원비례대표,(8)광역의원비례대표,(9)기초의원비례대표,(10)교육의원,(11)교육감
  '''</span>

  <span class="n">response</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">API_election_code_url</span><span class="p">)</span>
  <span class="n">json_str</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

  <span class="n">json_object</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>

  <span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="n">json_object</span><span class="p">[</span><span class="s">'getCommonSgCodeList'</span><span class="p">][</span><span class="s">'item'</span><span class="p">]]</span>

  <span class="n">election_code_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json_object</span><span class="p">[</span><span class="s">'getCommonSgCodeList'</span><span class="p">][</span><span class="s">'item'</span><span class="p">])</span>
  
  <span class="k">return</span> <span class="n">election_code_data</span>
</pre></table></code></div></div><p>대부분의 데이터 파싱 및 데이터프레임 제작 모듈은 위의 코드를 기반으로 제작되어 있습니다. 기본적인 API를 통해 데이터를 로드하기 전에 필요한 query를 설정하고 서비스키와 함께 요청을 보냅니다.</p><p>수신한 정보의 딕셔너리의 키값 중 ‘getCommonSgCodeList’의 ‘item’에서 데이터를 가져옵니다. 그렇게 불러온 데이터를 모두 DataFrame형태로 변환하여 데이터 전처리를 쉽게 진행하였습니다.</p><p><strong>3. 데이터 전처리</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">candidate_code_preprocessing</span><span class="p">():</span>
  <span class="n">election_code</span> <span class="o">=</span> <span class="n">election_code_preprocessing</span><span class="p">()</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">election_code</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>  
  <span class="n">election_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s">'sgId'</span><span class="p">,</span> <span class="s">'sgTypecode'</span><span class="p">]]</span>

  <span class="n">candidate_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>

  <span class="c1"># concat all candidate df
</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">election_data</span><span class="p">)):</span>
    <span class="n">curr_id</span> <span class="o">=</span> <span class="n">election_data</span><span class="p">[</span><span class="s">'sgId'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">curr_code</span> <span class="o">=</span> <span class="n">election_data</span><span class="p">[</span><span class="s">'sgTypecode'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">curr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">curr_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">curr_df</span> <span class="o">=</span> <span class="n">get_candidate_df</span><span class="p">(</span><span class="n">curr_id</span><span class="p">,</span> <span class="n">curr_code</span><span class="p">)</span>
    
    <span class="n">candidate_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">candidate_df</span><span class="p">,</span> <span class="n">curr_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  
  <span class="c1"># candidate column change
</span>  <span class="n">candidate</span> <span class="o">=</span> <span class="n">candidate_df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'NUM'</span><span class="p">,</span> <span class="s">'GIHO_SANGSE'</span><span class="p">,</span> <span class="s">'HANJA_NAME'</span><span class="p">,</span> <span class="s">'JOB_ID'</span><span class="p">,</span> <span class="s">'EDU_ID'</span><span class="p">,</span> <span class="s">'EDU'</span><span class="p">,</span> <span class="s">'CAREER1'</span><span class="p">,</span> <span class="s">'CAREER2'</span><span class="p">,</span> <span class="s">'AGE'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">candidate</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sgId'</span><span class="p">,</span> <span class="s">'sgTypecode'</span><span class="p">,</span> <span class="s">'cnddtId'</span><span class="p">,</span> <span class="s">'sggName'</span><span class="p">,</span> <span class="s">'sdName'</span><span class="p">,</span> <span class="s">'wiwName'</span><span class="p">,</span> <span class="s">'giho'</span><span class="p">,</span> <span class="s">'partyName'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'birthday'</span><span class="p">,</span><span class="s">'address'</span><span class="p">,</span> <span class="s">'job'</span><span class="p">,</span> <span class="s">'status'</span><span class="p">]</span>

  <span class="c1"># encoding data
</span>  <span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'gender'</span><span class="p">,</span> <span class="s">'status'</span><span class="p">]:</span>
    <span class="n">candidate</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">candidate</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

  <span class="c1"># giho null value
</span>  <span class="n">candidate</span><span class="p">[</span><span class="n">candidate</span><span class="p">[</span><span class="s">'giho'</span><span class="p">]</span> <span class="o">==</span> <span class="s">''</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="c1"># type matching to sql column type
</span>  <span class="n">candidate</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">.</span><span class="n">astype</span><span class="p">({</span><span class="s">'sgId'</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s">'sgTypecode'</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s">'cnddtId'</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s">'status'</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s">'giho'</span><span class="p">:</span><span class="nb">int</span><span class="p">})</span>
  <span class="n">candidate</span><span class="p">[</span><span class="s">'birthday'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">candidate</span><span class="p">[</span><span class="s">'birthday'</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s">'%Y-%m-%d'</span><span class="p">)</span>
  <span class="n">candidate</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'cnddtId'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

  <span class="n">cndd_idx</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">[</span><span class="n">candidate</span><span class="p">[</span><span class="s">'sgId'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">index</span>
  <span class="n">candidate</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cndd_idx</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">candidate</span>
</pre></table></code></div></div><p>데이터베이스를 설계할 때 필요한 컬럼들을 미리 설정했습니다. 따라서 데이터프레임의 구조를 파악하고 필요한 컬럼을 추출하거나 상황에 따라서는 scikit-learn의 LabelEncoder를 통해 데이터 식별을 했습니다. 사실상 설계와 제작에 가장 오랜시간이 걸린 부분이 데이터 전처리 파트였습니다.</p><hr /><h3 id="서버"><strong>서버</strong> <a href="#서버" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>서버는 배포를 위해 GCP (Google Cloud Platform)를 활용했습니다. 모든 API는 Node.js와 express로 제작되었으며 GET방식으로 송수신을 하게 설계하였습니다. </p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> <span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/CandInfo_do</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">sgId</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">date</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sggName</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">elecplace</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">sgId</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">sgId</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">sql</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">SELECT DISTINCT sgId FROM election_code; </span><span class="dl">'</span>
    <span class="kd">var</span> <span class="nx">sql1</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">SELECT * FROM candidate WHERE sgId LIKE '%</span><span class="dl">"</span><span class="o">+</span><span class="nx">sgId</span><span class="o">+</span><span class="dl">"</span><span class="s2">%' AND sggName LIKE '%</span><span class="dl">"</span><span class="o">+</span><span class="nx">sggName</span><span class="o">+</span><span class="dl">"</span><span class="s2">%' AND name LIKE '%</span><span class="dl">"</span><span class="o">+</span><span class="nx">name</span><span class="o">+</span><span class="dl">"</span><span class="s2">%' ORDER BY giho ASC; </span><span class="dl">"</span><span class="p">;</span>

    <span class="nx">conn</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">sql</span> <span class="o">+</span> <span class="nx">sql1</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">resultArray1</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])));</span>
        <span class="kd">var</span> <span class="nx">resultArray2</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])));</span>
        
        <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">"</span><span class="s2">CandInfo.html</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">codes</span> <span class="p">:</span> <span class="nx">resultArray1</span><span class="p">,</span> <span class="na">candList</span> <span class="p">:</span> <span class="nx">resultArray2</span> <span class="p">,</span> <span class="na">searchSgId</span><span class="p">:</span><span class="nx">sgId</span><span class="p">,</span> <span class="na">searchKey</span><span class="p">:</span> <span class="nx">sggName</span><span class="p">})</span>
      <span class="p">}</span>
    <span class="p">})</span>
  <span class="p">})</span>
</pre></table></code></div></div><p>페이지를 이동하는 API가 아닌 유저가 특정 동작을 수행할 경우 반환하는 API입니다. </p><p>github - <a href="https://github.com/cow-coding/V.O.T.E">https://github.com/cow-coding/V.O.T.E</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/project/'>Project</a>, <a href='/categories/vote/'>VOTE</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/projet/" class="post-tag no-text-decoration" >projet</a> <a href="/tags/java-script/" class="post-tag no-text-decoration" >java script</a> <a href="/tags/node-js/" class="post-tag no-text-decoration" >node.js</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/open-data/" class="post-tag no-text-decoration" >open data</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스 - Coding Gallery&url=https://cow-coding.github.io/posts/vote/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스 - Coding Gallery&u=https://cow-coding.github.io/posts/vote/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[알.쓸.선.잡] 공공데이터 활용 선거 및 국회의원 정보 제공 서비스 - Coding Gallery&url=https://cow-coding.github.io/posts/vote/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/coursera2_3/">[MLOps Specialization / Step2] Labeling Data</a><li><a href="/posts/module/">[BoostCamp AI Tech / 심화포스팅] torch.nn.Module 뜯어먹기</a><li><a href="/posts/list/">[Deep Dive Python] 2. List</a><li><a href="/posts/variable/">[Deep Dive Python] 1. Python의 객체와 변수 개념</a><li><a href="/posts/final7/">[BoostCamp AI Tech / Final] Day91 - Airflow setting 및 배치 파이프라인 설계</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tech/">AI Tech</a> <a class="post-tag" href="/tags/boostcamp/">BoostCamp</a> <a class="post-tag" href="/tags/naver/">NAVER</a> <a class="post-tag" href="/tags/deep-learning/">Deep Learning</a> <a class="post-tag" href="/tags/mlops/">MLOps</a> <a class="post-tag" href="/tags/data-engineering/">Data Engineering</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/basic/">Basic</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/recommender-system/">Recommender System</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/MDB1/"><div class="card-body"> <em class="timeago small" date="2020-08-19 00:00:00 +0900" >Aug 19, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Medipush Project] MongoDB</h3><div class="text-muted small"><p> 시작하며 몽고DB를 설치하고 활용하는 과정에서 GUI프로그램으로 Robo 3T를 사용하게된다. 기본적으로 파이썬 프로그래밍이나 DB를 다룰 때 사용되는 콘솔 명령어를 Robo 3T에서도 사용이 가능하지만, GUI 프로그램이므로 클릭으로도 형성이 가능한 경우가 많다. MongoDB 데이터베이스 생성방식 비콘솔 방식 위의 사진처럼 PC서버를 연결하...</p></div></div></a></div><div class="card"> <a href="/posts/medipush/"><div class="card-body"> <em class="timeago small" date="2020-08-21 00:00:00 +0900" >Aug 21, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Medipush Project] AWS connect</h3><div class="text-muted small"><p> 시작하며 기초적인 MongoDB 사용도 알았으니 이제 AWS 서버랑 연결해서 데이터베이스 구축을 해보자. 전체적인 구축 방식은 Google colab을 활용해서 의약품안전나라에 있는 의약품 정보를 크롤링해서 데이터베이스를 구축할 예정이다. 데이터베이스 저장위치는 AWS EC2를 활용할 예정이고 팀원 중 서버담당을 맡는 친구가 이미 AWS EC2 세...</p></div></div></a></div><div class="card"> <a href="/posts/database1/"><div class="card-body"> <em class="timeago small" date="2020-08-26 00:00:00 +0900" >Aug 26, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Medipush Project] Database 구축</h3><div class="text-muted small"><p> 시작하며 데이터베이스를 저장할 AWS 연결도 끝났고 이제 데이터베이스를 구축할 차례다. 데이터베이스 구축은 파이썬 크롤링을 통해서 만들 예정이다. 파이썬의 dictionary와 list를 적절히 잘 활용하면 단순히 코드로만 JSON형식의 파일을 만들 수 있다. 이번 프로젝트의 데이터베이스 MongoDB기반의 NoSQL이므로 총 2가지 document을...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/AIRushEnd/" class="btn btn-outline-primary" prompt="Older"><p>[Review] Naver AI Rush 2021 1 / 2라운드 후기</p></a> <a href="/posts/KakaoRecomTest/" class="btn btn-outline-primary" prompt="Newer"><p>[Review] 카카오 추천팀 겨울 인턴 2021 코테 후기</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://cow-coding.github.io/posts/vote/'; this.page.identifier = '/posts/vote/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://cow-coding.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/cow-coding">Park Kibum</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tech/">AI Tech</a> <a class="post-tag" href="/tags/boostcamp/">BoostCamp</a> <a class="post-tag" href="/tags/naver/">NAVER</a> <a class="post-tag" href="/tags/deep-learning/">Deep Learning</a> <a class="post-tag" href="/tags/mlops/">MLOps</a> <a class="post-tag" href="/tags/data-engineering/">Data Engineering</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/basic/">Basic</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/recommender-system/">Recommender System</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { loader: {load: ['[tex]/color']}, chtml: { scale: 1.2 }, tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ], packages: {'[+]':['color']} } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-163727422-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-163727422-1'); }); </script>
